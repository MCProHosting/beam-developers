=version 1
=resource User
=method delete
=endpoint /users/:id/2fa
=description Verifies and activates new two-factor authentication credentials.

include ../../_mixins.jade

p This verifies and activates the user's two-factor authentication credentials, using a code generated by their device.

h3 Parameters

table.endpoint-param-table
    tr
        td.name :id
        td.description The numeric user ID.
    tr
        td.name code
        td.description The numeric six-digit TOTP code.

h3 Possible Results

+result("Successful", "200 OK").
    "Code verified"

+result("Errorful", "200 OK").
    "Invalid code."

+result("Errorful", "404 Not Found", "If credentials have not been generated.")

+result("Errorful", "403 Forbidden").
    "You are not permitted to perform that action."
